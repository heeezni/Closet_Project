indexedDB: 브라우저에 내장된 비동기 NoSQL 데이터베이스 API

1. 많은 양의 구조화된 데이터를 클라이언트에 저장할 수 있다.
브라우저마다 편차는 있지만, 보통 HDD 용량의 50% 이다.
(Local Storage의 용량은 겨우 10MB이다.)

2. Javascript 기반의 객체지향 데이터베이스이다.
즉, Javascript가 인식할 수 있는 자료형과 객체를 저장할 수 있다!
(Local Storage는 String 형태만 저장할 수 있다.)

3. 트랜잭션을 사용하며 Key-Value 데이터베이스이다.
즉, key를 이용하여 자료를 검색해야한다

트랜잭션: "하나의 작업 단위"로, 전부 성공하거나, 전부 실패해야 하는 작업 묶음

4. IndexedDB는 비동기 API이다.

-------------------------------------------------------------------------------------

- onupgradeneeded
  Name 또는 Version과 일치하는 데이터베이스가 없는 경우 호출되며 데이터베이스를 생성한다.
- onsuccess
  Name과 Version 모두 일치하는 데이터베이스가 있는 경우 호출된다.
- onerror
  Name이 일치하지만 존재하는 DB의 Version 보다 낮은 Version을 호출하면 error가 발생한다.

- oncomplete
  트랜잭션이 전부 성공적으로 끝났을 때 실행되는 콜백 함수

IndexedDB는 비동기 방식이라
→ 작업(add, put 등)이 바로 끝나는 게 아니라, 시간이 걸림.
→ 그래서 완료된 후에 실행될 코드를 oncomplete에 넣는 것




--------------------------------------------------------------------------------------

createObjectStore(tableName) 함수를 이용하면 우리가 알고 있는 테이블을 만들 수 있다.
objectStore는 IndexedDB에서 데이터를 저장하는 “테이블” 같은 공간 (저장소)

⚠️ 주의할 점
이미지, 동영상 같은 파일은 크기가 크기 때문에 빠르게 한도를 넘을 수 있어

브라우저는 사용자가 최근에 사용하지 않은 웹사이트의 저장소를 자동 삭제하기도 해 (특히 모바일)

Base64로 저장하면 용량이 약 1.3배 증가함 → Blob/File 객체로 저장하는 게 낫다

